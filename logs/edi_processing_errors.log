{"timestamp": "2025-05-30T20:18:43.913769", "level": "ERROR", "logger": "src.config.config_manager", "message": "Failed to load configuration: Fernet key must be 32 url-safe base64-encoded bytes.", "module": "config_manager", "function": "_load_config", "line": 51, "taskName": null, "asctime": "2025-05-30 16:18:43,911"}
{"timestamp": "2025-05-30T20:19:58.656717", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: Incorrect padding", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 16:19:58,656"}
{"timestamp": "2025-05-30T20:19:58.658935", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 16:19:58,658"}
{"timestamp": "2025-05-30T20:19:58.685855", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Failed to create PostgreSQL connection pool: connection to server at \"localhost\" (::1), port 5432 failed: FATAL:  password authentication failed for user \"edi_user\"\n", "module": "postgresql_handler", "function": "_initialize_pool", "line": 51, "taskName": null, "asctime": "2025-05-30 16:19:58,685"}
{"timestamp": "2025-05-30T21:05:21.455205", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 17:05:21,455"}
{"timestamp": "2025-05-30T21:05:21.455372", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 17:05:21,455"}
{"timestamp": "2025-05-30T21:05:21.481334", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Failed to create PostgreSQL connection pool: connection to server at \"localhost\" (::1), port 5432 failed: FATAL:  password authentication failed for user \"postgres\"\n", "module": "postgresql_handler", "function": "_initialize_pool", "line": 51, "taskName": null, "asctime": "2025-05-30 17:05:21,481"}
{"timestamp": "2025-05-30T21:13:33.908440", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 17:13:33,908"}
{"timestamp": "2025-05-30T21:13:41.548641", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Database executemany error: column \"is_principal\" of relation \"diagnoses\" does not exist\nLINE 4:             diagnosis_sequence, is_principal\n                                        ^\n", "module": "postgresql_handler", "function": "execute_many", "line": 109, "taskName": null, "asctime": "2025-05-30 17:13:41,548"}
{"timestamp": "2025-05-30T21:13:41.548999", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query: \n        INSERT INTO edi.diagnoses (\n            claim_id, diagnosis_code, diagnosis_type, description, \n            diagnosis_sequence, is_principal\n        ) VALUES (%s, %s, %s, %s, %s, %s)\n        ", "module": "postgresql_handler", "function": "execute_many", "line": 110, "taskName": null, "asctime": "2025-05-30 17:13:41,548"}
{"timestamp": "2025-05-30T21:13:41.549225", "level": "ERROR", "logger": "__main__", "message": "Error loading sample data: column \"is_principal\" of relation \"diagnoses\" does not exist\nLINE 4:             diagnosis_sequence, is_principal\n                                        ^\n", "module": "load", "function": "load_sample_data", "line": 156, "taskName": null, "asctime": "2025-05-30 17:13:41,549"}
{"timestamp": "2025-05-30T21:13:41.629364", "level": "ERROR", "logger": "__main__", "message": "\u2717 Data loading operation failed", "module": "load", "function": "main", "line": 491, "taskName": null, "asctime": "2025-05-30 17:13:41,628"}
{"timestamp": "2025-05-30T21:15:40.656844", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 17:15:40,656"}
{"timestamp": "2025-05-30T21:16:06.391780", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Database executemany error: value too long for type character varying(20)\n", "module": "postgresql_handler", "function": "execute_many", "line": 109, "taskName": null, "asctime": "2025-05-30 17:16:06,391"}
{"timestamp": "2025-05-30T21:16:06.392028", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query: \n        INSERT INTO edi.procedures (\n            claim_id, procedure_code, procedure_type, description, \n            service_date, procedure_sequence, charge_amount, diagnosis_pointers\n        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s)\n        ", "module": "postgresql_handler", "function": "execute_many", "line": 110, "taskName": null, "asctime": "2025-05-30 17:16:06,391"}
{"timestamp": "2025-05-30T21:16:06.392177", "level": "ERROR", "logger": "__main__", "message": "Error loading sample data: value too long for type character varying(20)\n", "module": "load", "function": "load_sample_data", "line": 156, "taskName": null, "asctime": "2025-05-30 17:16:06,392"}
{"timestamp": "2025-05-30T21:16:06.482939", "level": "ERROR", "logger": "__main__", "message": "\u2717 Data loading operation failed", "module": "load", "function": "main", "line": 491, "taskName": null, "asctime": "2025-05-30 17:16:06,482"}
{"timestamp": "2025-05-30T21:16:48.299935", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 17:16:48,299"}
{"timestamp": "2025-05-30T22:38:53.932765", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 18:38:53,932"}
{"timestamp": "2025-05-30T22:38:54.907828", "level": "ERROR", "logger": "__main__", "message": "Error loading sample data: 'PostgreSQLHandler' object has no attribute 'execute_many'", "module": "load", "function": "load_sample_data", "line": 156, "taskName": null, "asctime": "2025-05-30 18:38:54,907"}
{"timestamp": "2025-05-30T22:38:54.927555", "level": "ERROR", "logger": "__main__", "message": "\u2717 Data loading operation failed", "module": "load", "function": "main", "line": 491, "taskName": null, "asctime": "2025-05-30 18:38:54,927"}
{"timestamp": "2025-05-30T23:07:26.403010", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 19:07:26,402"}
{"timestamp": "2025-05-30T23:07:27.390315", "level": "ERROR", "logger": "__main__", "message": "Error loading sample data: 'PostgreSQLHandler' object has no attribute 'execute_many'", "module": "load", "function": "load_sample_data", "line": 156, "taskName": null, "asctime": "2025-05-30 19:07:27,390"}
{"timestamp": "2025-05-30T23:07:27.409140", "level": "ERROR", "logger": "__main__", "message": "\u2717 Data loading operation failed", "module": "load", "function": "main", "line": 491, "taskName": null, "asctime": "2025-05-30 19:07:27,408"}
{"timestamp": "2025-05-30T23:10:02.810476", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 19:10:02,810"}
{"timestamp": "2025-05-30T23:10:19.162906", "level": "ERROR", "logger": "__main__", "message": "Bulk insert failed, trying fallback method: there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "load", "function": "execute_bulk_insert", "line": 78, "taskName": null, "asctime": "2025-05-30 19:10:19,162"}
{"timestamp": "2025-05-30T23:10:19.183069", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query execution error: there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "postgresql_handler", "function": "execute_query", "line": 74, "taskName": null, "asctime": "2025-05-30 19:10:19,182"}
{"timestamp": "2025-05-30T23:10:19.183276", "level": "ERROR", "logger": "__main__", "message": "Failed to insert row ('Age_Under_18_Preventive_Care', 'has_diagnosis(X, Code) & patient_age(X, Age) & (Age < 18) & preventive_code(Code)', 'Validate preventive care codes for patients under 18', 'MANUAL'): there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "load", "function": "_fallback_bulk_insert", "line": 88, "taskName": null, "asctime": "2025-05-30 19:10:19,183"}
{"timestamp": "2025-05-30T23:10:19.183627", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query execution error: there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "postgresql_handler", "function": "execute_query", "line": 74, "taskName": null, "asctime": "2025-05-30 19:10:19,183"}
{"timestamp": "2025-05-30T23:10:19.183858", "level": "ERROR", "logger": "__main__", "message": "Failed to insert row ('High_Cost_Specialist_Review', 'charge_amount(X, Amount) & provider_type(X, \"SPECIALIST\") & (Amount > 1000)', 'Flag high-cost specialist claims for review', 'MANUAL'): there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "load", "function": "_fallback_bulk_insert", "line": 88, "taskName": null, "asctime": "2025-05-30 19:10:19,183"}
{"timestamp": "2025-05-30T23:10:19.184283", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query execution error: there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "postgresql_handler", "function": "execute_query", "line": 74, "taskName": null, "asctime": "2025-05-30 19:10:19,184"}
{"timestamp": "2025-05-30T23:10:19.184497", "level": "ERROR", "logger": "__main__", "message": "Failed to insert row ('Emergency_Room_Diagnosis_Check', 'place_of_service(X, \"23\") & has_diagnosis(X, Code) & emergency_appropriate(Code)', 'Validate diagnosis codes are appropriate for emergency room visits', 'MANUAL'): there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "load", "function": "_fallback_bulk_insert", "line": 88, "taskName": null, "asctime": "2025-05-30 19:10:19,184"}
{"timestamp": "2025-05-30T23:10:19.185025", "level": "ERROR", "logger": "src.database.postgresql_handler", "message": "Query execution error: there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "postgresql_handler", "function": "execute_query", "line": 74, "taskName": null, "asctime": "2025-05-30 19:10:19,184"}
{"timestamp": "2025-05-30T23:10:19.185316", "level": "ERROR", "logger": "__main__", "message": "Failed to insert row ('Diabetes_Management_Protocol', 'has_diagnosis(X, \"E11.9\") & has_procedure(X, ProcCode) & diabetes_management(ProcCode)', 'Ensure proper procedures for diabetes management', 'MANUAL'): there is no unique or exclusion constraint matching the ON CONFLICT specification\n", "module": "load", "function": "_fallback_bulk_insert", "line": 88, "taskName": null, "asctime": "2025-05-30 19:10:19,185"}
{"timestamp": "2025-05-30T23:46:19.539270", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 19:46:19,539"}
{"timestamp": "2025-05-30T23:53:50.809462", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 19:53:50,809"}
{"timestamp": "2025-05-30T23:53:50.874426", "level": "ERROR", "logger": "__main__", "message": "Database validation failed: 0", "module": "load", "function": "validate_database_connection", "line": 266, "taskName": null, "asctime": "2025-05-30 19:53:50,874"}
{"timestamp": "2025-05-30T23:53:50.874733", "level": "ERROR", "logger": "__main__", "message": "Database validation failed, aborting data load", "module": "load", "function": "load_sample_data", "line": 274, "taskName": null, "asctime": "2025-05-30 19:53:50,874"}
{"timestamp": "2025-05-30T23:53:50.874898", "level": "ERROR", "logger": "__main__", "message": "\u2717 Data loading operation failed", "module": "load", "function": "main", "line": 436, "taskName": null, "asctime": "2025-05-30 19:53:50,874"}
{"timestamp": "2025-05-30T23:57:33.821100", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 19:57:33,820"}
{"timestamp": "2025-05-31T00:09:04.441833", "level": "ERROR", "logger": "src.utils.encryption", "message": "Decryption error: ", "module": "encryption", "function": "decrypt_value", "line": 51, "taskName": null, "asctime": "2025-05-30 20:09:04,441"}
{"timestamp": "2025-05-31T00:31:06.964989", "level": "ERROR", "logger": "__main__", "message": "Fatal error: Duplicated timeseries in CollectorRegistry: {'claims_processed_total', 'claims_processed', 'claims_processed_created'}", "module": "run_edi", "function": "main", "line": 90, "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\run_edi.py\", line 80, in main\n    system = EDIProcessingSystem(config)\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\main.py\", line 302, in __init__\n    self.metrics = MetricsCollector()\n                   ~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\monitoring\\metrics.py\", line 17, in __init__\n    self._initialize_metrics()\n    ~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\monitoring\\metrics.py\", line 22, in _initialize_metrics\n    self.claims_processed_total = Counter(\n                                  ~~~~~~~^\n        'claims_processed_total',\n        ^^^^^^^^^^^^^^^^^^^^^^^^^\n        'Total number of claims processed'\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\jonmc\\tools\\python\\Lib\\site-packages\\prometheus_client\\metrics.py\", line 132, in __init__\n    registry.register(self)\n    ~~~~~~~~~~~~~~~~~^^^^^^\n  File \"C:\\Users\\jonmc\\tools\\python\\Lib\\site-packages\\prometheus_client\\registry.py\", line 43, in register\n    raise ValueError(\n        'Duplicated timeseries in CollectorRegistry: {}'.format(\n            duplicates))\nValueError: Duplicated timeseries in CollectorRegistry: {'claims_processed_total', 'claims_processed', 'claims_processed_created'}", "taskName": null, "asctime": "2025-05-30 20:31:06,962"}
{"timestamp": "2025-05-31T01:03:56.318107", "level": "ERROR", "logger": "database.sqlserver_handler", "message": "Failed to initialize SQL Server connections: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')", "module": "sqlserver_handler", "function": "_initialize_connections", "line": 39, "taskName": null, "asctime": "2025-05-30 21:03:56,317"}
{"timestamp": "2025-05-31T01:03:56.318303", "level": "ERROR", "logger": "main", "message": "Error during EDI system initialization: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')", "module": "main", "function": "__init__", "line": 350, "taskName": null, "asctime": "2025-05-30 21:03:56,318"}
{"timestamp": "2025-05-31T01:03:56.319998", "level": "ERROR", "logger": "__main__", "message": "Fatal error: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')", "module": "run_edi", "function": "main", "line": 90, "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\run_edi.py\", line 80, in main\n    system = EDIProcessingSystem(config)\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\main.py\", line 323, in __init__\n    self.sqlserver_handler = SQLServerHandler(config['database']['sqlserver'])\n                             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\database\\sqlserver_handler.py\", line 27, in __init__\n    self._initialize_connections()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\jonmc\\Documents\\development\\pro\\src\\database\\sqlserver_handler.py\", line 33, in _initialize_connections\n    conn = pyodbc.connect(self.connection_string)\npyodbc.InterfaceError: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')", "taskName": null, "asctime": "2025-05-30 21:03:56,318"}
{"timestamp": "2025-05-31T01:08:31.519788", "level": "ERROR", "logger": "database.postgresql_handler", "message": "Query execution error: column d.sequence_number does not exist\nLINE 15:                         'sequence', d.sequence_number,\n                                             ^\n", "module": "postgresql_handler", "function": "execute_query", "line": 74, "taskName": null, "asctime": "2025-05-30 21:08:31,519"}
{"timestamp": "2025-05-31T01:08:31.520105", "level": "ERROR", "logger": "parser", "message": "Error fetching enriched claim batch: column d.sequence_number does not exist\nLINE 15:                         'sequence', d.sequence_number,\n                                             ^\n", "module": "parser", "function": "_fetch_enriched_claim_batch", "line": 98, "taskName": null, "asctime": "2025-05-30 21:08:31,519"}
{"timestamp": "2025-05-31T01:08:31.544101", "level": "ERROR", "logger": "database.sqlserver_handler", "message": "Cleanup error: ('The SQL contains 0 parameter markers, but 1 parameters were supplied', 'HY000')", "module": "sqlserver_handler", "function": "cleanup_old_results", "line": 132, "taskName": null, "asctime": "2025-05-30 21:08:31,543"}
{"timestamp": "2025-05-31T01:08:31.544437", "level": "ERROR", "logger": "database.sqlserver_handler", "message": "Statistics query error: ('The SQL contains 0 parameter markers, but 1 parameters were supplied', 'HY000')", "module": "sqlserver_handler", "function": "get_validation_statistics", "line": 170, "taskName": null, "asctime": "2025-05-30 21:08:31,544"}
